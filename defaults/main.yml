#Be advised that enabling the Firewall BEFORE obtaining the letsencrypt
#certificate will prevent correct certificate generation, because an IP from out
#of the cloudflare chain will try to access the website
#
#
#alpine image used for volume backup and restores
alpine_image: alpine

iptables_rules: |
  -A whatever blablabla

#if left undefined a key will be automatically created
tor_hidden_service_private_key:

WP_BACKUP_FILE: "wpbk.tar.bz2"
WP_DB_BACKUP_FILE: "dbbk.tar.bz2"
NGINX_BACKUP_FILE: "nginxbk.tar.bz2"

WP_VOLUME: "wordpress_volume"
DB_VOLUME: "maria_volume"
NGINX_VOLUME: "nginx_volume"

#where the wordpress website should be reachable
wordpress_ip_addr: "10.10.10.1"

wordpress_domain_name: "wordpress.local"
SSL: True

wordpress_letsencrypt_mail: "none@throwaway.devnull"
#disabled when setting up a site, enable it when deploying to production
letsencrypt_testmode: "true"

#do you want a hidden service too?
TOR_HH: True

#Do you want to only allow connections from cloudflare?
CLOUDFLARE: True

#prefix to all containers because of docker_compose
project_name: wpstack

database_password: disisasecurepassw00rdz0r

#example iptables rules, keep in mind those are far too permissive
#so update them. They are here to show the bare bone logic
iptables_rules: |
  # Generated by iptables-save v1.4.21 on Fri Sep 15 10:17:26 2017
  *nat
  :PREROUTING ACCEPT [470092:34422566]
  :INPUT ACCEPT [233215:16170653]
  :OUTPUT ACCEPT [886:59737]
  :POSTROUTING ACCEPT [32064:1924465]
  COMMIT
  # Completed on Fri Sep 15 10:17:26 2017
  # Generated by iptables-save v1.4.21 on Fri Sep 15 10:17:26 2017
  *filter
  :INPUT ACCEPT [2265:903286]
  :FORWARD ACCEPT [48:2824]
  :OUTPUT ACCEPT [2133:893511]
  :CloudflareChain - [0:0]
  :fail2ban-ssh - [0:0]
  -A INPUT -p tcp -m multiport --dports 22 -j fail2ban-ssh
  -A INPUT -i eth0 -p tcp -m tcp --dport 80 -m state --state NEW,ESTABLISHED -j CloudflareChain
  -A INPUT -i eth0 -p tcp -m tcp --dport 443 -m state --state NEW,ESTABLISHED -j CloudflareChain
  -A CloudflareChain -m set --match-set cloudflare src -j RETURN
  -A CloudflareChain -j DROP
  -A fail2ban-ssh -j RETURN
  COMMIT
  # Completed on Fri Sep 15 10:17:26 2017
